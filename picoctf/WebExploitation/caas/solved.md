# TITLE : caas
## Author : BrownieInMotion
## Description
Now presenting [cowsay as a service](https://caas.mars.picoctf.net/)
## Solution
In this problem, the web app gives us the following task:
```
Make a request to the following URL to cowsay your message:
https://caas.mars.picoctf.net/cowsay/{message}
```
The response will display the message we input. At first, this didnâ€™t give me a clue, so I checked the provided .js file.  
Inside the file, I found a part that seemed vulnerable:
```javascript
exec(`/usr/games/cowsay ${req.params.message}`)
```
This web application uses exec to process the input message. The exec function can spawn a shell (e.g., /bin/sh on Unix) and run the entire command string inside it. This means it is potentially vulnerable to command injection.

I tested this by adding a semicolon (;) after my message to chain another command, like this:
```
https://caas.mars.picoctf.net/cowsay/fwsefwf;%20ls
```
The server responded with a list of files in the directory. Among them, I noticed the flag file. I then ran:
```
https://caas.mars.picoctf.net/cowsay/fwsefwf;%20cat%20flag.txt
```
This revealed the flag.
