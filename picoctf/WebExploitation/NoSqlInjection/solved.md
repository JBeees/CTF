# TITLE : No Sql Injection
## Author : NGIRIMANA Schadrack
## Description 
Can you try to get access to this website to get the flag?
You can download the source [here](https://artifacts.picoctf.net/c_atlas/36/app.tar.gz).
The website is running here. Can you log in?
## Hints
- Not only SQL injection exist but also NonSQL injection exists.
- Make sure you look at everything the server is sending back.
## Solution
In this challenge, we are given the source code of the page. While analyzing it, I found a vulnerability in the `server.js` file, specifically in this part:
```
const user = await User.findOne({
          email:
            email.startsWith("{") && email.endsWith("}")
              ? JSON.parse(email)
              : email,
          password:
            password.startsWith("{") && password.endsWith("}")
              ? JSON.parse(password)
              : password,
        });
```
This means that if the submitted email or password starts with { and ends with }, the server will run JSON.parse() on it and pass the parsed value into the MongoDB query.

I exploited this by injecting a MongoDB operator payload into both the email and password fields `{ "$exists": true }` which means. MongoDB will look for any document in the users collection where the email field exists and the password field exists.
As a result, I was able to bypass authentication and log in without knowing the real credentials.

After logging in, I intercepted the response using Burp Suite. The response contained a token encoded in Base64. I decoded it and obtained the flag.

