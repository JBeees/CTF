# TITLE : Stonks
## Author : madStacks
## Description 
I decided to try something noone else has before. I made a bot to automatically trade stonks for me using AI and machine learning. I wouldn't believe you if you told me it's unsecure! vuln.c nc mercury.picoctf.net 53437
## Hints 
- Okay, maybe I'd believe you if you find my API key.
## Solution
From the provided source code, we can identify a function named buy_stonks that loads the flag into a buffer called api_buf. Interestingly, the code also contains a format string vulnerability at the line:
<pre>printf(user_buf);</pre>
Since user_buf is user-controlled input and passed directly into printf without a format string, this introduces a classic format string vulnerability.

We can exploit this by supplying a payload like %x%x%x... to leak stack memory in hexadecimal format. Among the leaked values, the contents of api_buf (which holds the flag) can be found though it will appear hex-encoded.

To reconstruct the flag:

- Input a series of %x format specifiers (e.g., %x%x%x%x) until you see hex values resembling ASCII.
- Copy the leaked hex values.
- Use a tool like CyberChef to convert the hex into readable text.
- The output might be out of order, so youâ€™ll likely need to rearrange the chunks to get the correct flag.

## Flag
<pre>picoCTF{I_l05t_4ll_my_m0n3y_bdc425ea}</pre>
