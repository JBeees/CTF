# TITLE : buffer overflow 1
## Author : Sanjay C / Palash Oswal
## Description : 
Control the return address
Now we're cooking! You can overflow the buffer and return to the flag function in the [program](https://artifacts.picoctf.net/c/185/vuln).
You can view source [here](https://artifacts.picoctf.net/c/185/vuln.c). 
## Hints
- Make sure you consider big Endian vs small Endian.
- Changing the address of the return pointer can call different functions.

## Solution
Looking at the source code, we notice that the program calls the vuln() function, which uses the dangerous gets() function to read user input.
Since gets() doesn't check input length, we can overflow buf and overwrite the saved return address on the stack. The goal is to overwrite it with the address of the win() function so that it runs when vuln() returns.  
To automate this, we'll use Pwntools.'

### Step 1: Find the Overflow Offset
Use a cyclic pattern to identify how many bytes are needed to reach the return address:
![find the offset](/findoff.png)
Once the crash occurs, note the value of EIP (or RIP for 64-bit). Use it with cyclic_find() to determine the exact offset:
![Got the offset](/off.png)
you can see that, the return address given is showing the hex of your input. Now we know that we can overwrite this with the address of the win func. But we have to find the exact number where the offset is. to do that you can do command below.
![Offset num](/numoff.png)

### Step 2: Find the Address of win()
 Below is the way to get the win address.
![Win address](/winadd.png)
From the image above, we get the win address in little endian format. so now we have eveything to get the payload. Below is the example of the payload.
### Step 3: Craft the Payload
Now construct a payload:
- Fill with padding (based on the offset you found, e.g., 44 bytes) 
- Add the address of win() in little-endian format.
![Payload](/payload.png)
### Step 4: Exploit the Program
Last To get the flag, you can do command below
![Flag](/flag.png)
## Flag
picoCTF{addr3ss3s_ar3_3asy_6462ca2d}


