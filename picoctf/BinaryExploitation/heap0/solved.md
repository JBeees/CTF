# TITLE : heap 0
## Author :  Abrxs, pr1or1tyQ
## Description
Are overflows just a stack concern?
Download the binary [here](https://artifacts.picoctf.net/c_tethys/28/chall).
Download the source [here](https://artifacts.picoctf.net/c_tethys/28/chall.c).
Additional details will be available after launching your challenge instance.

## Solution

From the given C file, we can determine that the goal is to change the value of safe_var to "pico" in order to retrieve the flag. When running the binary, the init function reveals the heap addresses of both the user-controlled input and safe_var. To overwrite safe_var, we need to calculate the offset between these two addresses, since the input is stored before safe_var on the heap.

By subtracting the input address from the safe_var address, we find that the distance is 32 bytes. This means that by sending a payload of 32 arbitrary characters followed by "pico", such as:

<pre> ``` aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaapico ``` </pre>
we can overwrite the content of safe_var. Once it's set to "pico", the condition is satisfied, and the program will reveal the flag. Craft this input and run the executable â€” you should now be able to GET THE FLAG.
